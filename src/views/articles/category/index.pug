extends ../../_partials/layout.pug

block vars
  - bodyClass = 'articles'

block main

  - yearsArray = []

  each post in posts

    -
      const thisYear = post.date.split('-')[0];

      if (yearsArray.indexOf(thisYear) === -1) {
        yearsArray.push(thisYear);
      }

  - yearsArray.sort((a, b) => {return b-a});

  main
    .main-container.container
      .columns
        .column.is-two-thirds-widescreen.is-full
          .section.section-posts.section-articles


            each category in categories

              - const disabledCategories = ['journal', 'text', 'fiction', 'poetry', 'academic', 'essay', 'esej'];

              if (!disabledCategories.includes(category.slug) && category.count > 0)

                h2.section-title(id=category.slug) # #{category.name}

                each post in posts

                  if (post.categories.includes(category.id))

                    +post_thumb(post)


        .column.is-one-third-widescreen.is-full
          .aside.aside-articles
            h2.aside-title recent articles

            - let limit = 5;
            - let current = 0;

            each article in posts
              if (current < limit)

                - const isFiction = article.categories.includes(303);
                - const isPoetry = article.categories.includes(304);
                - const isAcademic = article.categories.includes(8);

                if (!isAcademic && !isPoetry && !isFiction)

                  +post_thumb(article)

                  - current = current + 1


          .aside.aside-categories

            h2.aside-title by year

            each date in yearsArray

              span.post-thumb.post-thumb-aside.post-thumb-aside-inline
                a(href=`/articles/by-year/#${date}`) #{date}

            .aside-footer
              a(href="#") show all by date

          .aside.aside-categories

            h2.aside-title categories

            - limit = 100;
            - current = 0;

            each category in categories
              if (current < limit)

                - const disabledCategories = ['journal', 'text', 'fiction', 'poetry', 'academic', 'essay', 'esej'];

                if (!disabledCategories.includes(category.slug) && category.count > 0)
                  article.post-thumb.post-thumb-aside
                    a(href=`/articles/category/#${category.slug}`) # #{category.name}

                  - current = current + 1

            .aside-footer
              a(href="/articles/category") show all categories



block foot

